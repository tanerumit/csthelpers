% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scenario_surface_weights_cop.R
\name{copula_goodness_of_fit}
\alias{copula_goodness_of_fit}
\title{Copula Goodness-of-Fit Diagnostic}
\usage{
copula_goodness_of_fit(
  u_obs,
  v_obs,
  rho,
  w_obs = NULL,
  n_grid = 10L,
  tail_threshold = 0.1,
  warn_threshold = 0.05
)
}
\arguments{
\item{u_obs, v_obs}{Pseudo-observations in (0,1), typically from KDE CDFs}

\item{rho}{Fitted Gaussian copula correlation}

\item{w_obs}{Optional normalized observation weights}

\item{n_grid}{Number of grid points per dimension for comparison (default 10)}

\item{tail_threshold}{Quantile threshold defining "tail" region (default 0.1)}

\item{warn_threshold}{RMSE threshold above which to flag poor fit}
}
\value{
List with:
  - `rmse`: Root mean squared error between empirical and fitted copula
  - `max_abs_error`: Maximum absolute discrepancy
  - `tail_lower_rmse`: RMSE in lower-left tail (both u,v < tail_threshold)
  - `tail_upper_rmse`: RMSE in upper-right tail (both u,v > 1-tail_threshold)
  - `tail_discrepancy`: Combined tail metric (max of lower/upper)
  - `n_eval`: Number of evaluation points
  - `poor_fit`: Logical flag if fit appears inadequate
  - `poor_fit_reason`: Character explanation if flagged
  - `grid`: Data frame of evaluation points and values (for plotting)
}
\description{
Compares empirical copula to fitted Gaussian copula at a grid of quantile
points. Returns overall discrepancy metrics and tail-specific diagnostics.
}
