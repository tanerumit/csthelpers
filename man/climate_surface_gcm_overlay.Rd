% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/climate_surface_gcm_overlay.R
\name{climate_surface_gcm_overlay}
\alias{climate_surface_gcm_overlay}
\title{Overlay GCM information on a climate response surface plot}
\usage{
climate_surface_gcm_overlay(
  p,
  gcm_data = NULL,
  x_var = NULL,
  y_var = NULL,
  scenario_var = "scenario",
  horizon_var = "horizon",
  scenario_levels = NULL,
  horizon_levels = NULL,
  scenario_colors = c(ssp126 = "#003466", ssp245 = "#f69320", ssp370 = "#df0000", ssp585
    = "#980002"),
  horizon_shapes = c(near = 1, far = 4),
  alpha = 0.75,
  size = 2.4,
  stroke = 1.2,
  show_legend = TRUE,
  ellipse_levels = NULL,
  ellipse_group = c("none", "scenario", "horizon", "scenario_horizon"),
  ellipse_color = "gray30",
  ellipse_linetype = "dashed",
  ellipse_linewidth = 0.5
)
}
\arguments{
\item{p}{A ggplot object, typically returned by \code{\link{climate_surface_base}}.}

\item{gcm_data}{A data frame containing GCM summary points. At minimum, this must include
numeric columns for the x- and y-axes (e.g. precipitation and temperature
changes), and categorical columns defining scenarios and time horizons.}

\item{x_var, y_var}{Names of the x and y columns in \code{gcm_data}. If \code{NULL}, these are
inferred from attributes attached to \code{p} by
\code{climate_surface_base}.}

\item{scenario_var}{Name of the column in \code{gcm_data} identifying emission scenarios
(e.g. \code{"ssp126"}, \code{"ssp245"}).}

\item{horizon_var}{Name of the column in \code{gcm_data} identifying time horizons
(e.g. \code{"near"}, \code{"far"}).}

\item{scenario_levels}{Optional character vector specifying which scenarios to include and their
plotting order. If supplied, scenarios not listed are dropped.}

\item{horizon_levels}{Optional character vector specifying which horizons to include and their
plotting order.}

\item{scenario_colors}{Named character vector mapping scenario names to colors. Names must match the
values (or factor levels) in \code{scenario_var}.}

\item{horizon_shapes}{Named integer vector mapping horizon names to point shapes. Names must match
the values (or factor levels) in \code{horizon_var}.}

\item{alpha}{Transparency of GCM points (0–1). Useful for dense ensembles.}

\item{size}{Point size for GCM markers (ggplot2 units).}

\item{stroke}{Stroke width for GCM point outlines.}

\item{show_legend}{Logical. If \code{FALSE}, suppresses all GCM-related legends (scenario and
horizon), while leaving the surface legend untouched.}

\item{ellipse_levels}{Optional numeric vector of confidence levels (values strictly between 0 and 1)
at which to draw bivariate-normal ellipses using \code{stat_ellipse()}.
For example, \code{c(0.5, 0.9)}.}

\item{ellipse_group}{Controls grouping for ellipse estimation:
\itemize{
  \item \code{"none"}: one ellipse per level using all GCM points,
  \item \code{"scenario"}: separate ellipses per scenario,
  \item \code{"horizon"}: separate ellipses per horizon,
  \item \code{"scenario_horizon"}: separate ellipses for each
        scenario–horizon combination.
}}

\item{ellipse_color}{Line color for ellipses when \code{ellipse_group = "none"} or when a fixed
color is desired.}

\item{ellipse_linetype}{Line type for ellipses (e.g. \code{"dashed"}).}

\item{ellipse_linewidth}{Line width for ellipses.}
}
\value{
A ggplot object consisting of the original climate response surface with
GCM points and optional ellipses overlaid.
}
\description{
Adds Global Climate Model (GCM) summary information—typically scenario–horizon
change signals—to an existing climate response surface created with
\code{\link{climate_surface_base}}.

The function overlays:
\itemize{
  \item GCM points positioned in the same \code{(x, y)} climate-change space
        as the response surface (e.g. \eqn{\Delta}precipitation vs
        \eqn{\Delta}temperature),
  \item scenario-specific colors and horizon-specific point shapes,
  \item optional bivariate-normal confidence ellipses summarizing the GCM
        ensemble spread.
}

The underlying response surface is **not modified**; this function only adds
new ggplot layers and legend entries.
}
\details{
\strong{Facet compatibility:} If the base surface plot is faceted
(via \code{facet_by} in \code{climate_surface_base}), the same facet variable
must be present in \code{gcm_data}. Otherwise, GCM points will be recycled
into all panels.

\strong{Axis consistency:} When available, axis limits stored as attributes
on the base plot (\code{x_breaks}, \code{y_breaks}) are used to clip
\code{gcm_data} before plotting, ensuring GCM points and ellipses are confined
to the visible plotting domain.
}
\seealso{
\code{\link{climate_surface_base}}, \code{\link[ggplot2]{stat_ellipse}}
}
