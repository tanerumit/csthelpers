% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcm_weights_pi.R
\name{compute_weighted_ensemble_stats}
\alias{compute_weighted_ensemble_stats}
\title{Compute weighted ensemble summary statistics by scenario}
\usage{
compute_weighted_ensemble_stats(
  gcm_data,
  weights_df,
  model_col = "model",
  scenario_col = "scenario",
  target_col,
  weight_col = "w_bma",
  quantiles = c(0.1, 0.5, 0.9)
)
}
\arguments{
\item{gcm_data}{data.frame containing model projections including `target_col`,
`model_col`, and `scenario_col`.}

\item{weights_df}{data.frame containing weights with columns `model`, `scenario`,
and `weight_col`.}

\item{model_col}{Character scalar model column name in `gcm_data`.}

\item{scenario_col}{Character scalar scenario column name in `gcm_data`.}

\item{target_col}{Character scalar target variable column in `gcm_data`.}

\item{weight_col}{Character scalar weight column in `weights_df`. Default `"w_bma"`.}

\item{quantiles}{Numeric vector of probabilities in [0,1] for weighted quantiles.}
}
\value{
data.frame with one row per scenario and columns:
`scenario`, `weighted_mean`, `weighted_sd`, `n_records`, `n_eff`, and quantiles.
}
\description{
Computes weighted mean, weighted standard deviation, effective sample size,
and weighted quantiles per scenario using model weights.
}
\details{
Weights are merged into `gcm_data` at the model-scenario level. Non-finite
weights are set to zero (explicit exclusion). If the remaining weight sum is
degenerate, the function falls back to uniform weights over remaining records.

Weighted quantiles are computed by CDF inversion over sorted values.
}
\examples{
\dontrun{
stats <- compute_weighted_ensemble_stats(
  gcm_data = gcm,
  weights_df = w,
  target_col = "flow"
)
}

}
