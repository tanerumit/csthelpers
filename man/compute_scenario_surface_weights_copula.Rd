% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scenario_surface_weights_copula.R
\name{compute_scenario_surface_weights_copula}
\alias{compute_scenario_surface_weights_copula}
\title{Calculate Climate-Informed Scenario Surface Weights (Gaussian copula; KDE marginals)}
\usage{
compute_scenario_surface_weights_copula(
  ensemble_data,
  scenario_grid,
  pr_col = "prcp",
  ta_col = "tavg",
  group_col = "scenario",
  bw = NULL,
  bw_method = c("nrd0", "nrd", "sj"),
  k = c(1.5, 2),
  alpha = 1,
  bw_min = c(0, 0),
  bw_max = c(Inf, Inf),
  min_samples = 5L,
  normalize = TRUE,
  area_weight = c("regular", "none"),
  scale = c("none", "global", "by_group"),
  weights_col = NULL,
  support = NULL,
  chunk_size = 5000L,
  gof_diagnostics = TRUE,
  gof_n_grid = 10L,
  gof_warn_threshold = 0.05,
  diagnostics = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{ensemble_data}{Data frame containing ensemble projections.}

\item{scenario_grid}{Data frame defining the evaluation surface (not necessarily regular).}

\item{pr_col}{Column name for precipitation variable.}

\item{ta_col}{Column name for temperature variable.}

\item{group_col}{Column name for grouping (e.g., scenario).}

\item{bw}{Optional marginal bandwidth vector c(bw_ta, bw_pr) in original units.}

\item{bw_method}{1D bandwidth method: "nrd0", "nrd", or "sj".}

\item{k}{Grid-step multipliers for bandwidth floor (same semantics as KDE).}

\item{alpha}{Multiplier for data-driven (1D) bandwidth.}

\item{bw_min}{Minimum bandwidth bounds (per marginal).}

\item{bw_max}{Maximum bandwidth bounds (per marginal).}

\item{min_samples}{Minimum observations required per group.}

\item{normalize}{Logical; normalize weights to sum to 1?}

\item{area_weight}{Area weighting method: "regular" or "none".}

\item{scale}{Scaling method: "none", "global", or "by_group".}

\item{weights_col}{Optional column with per-row weights.}

\item{support}{Optional list with ta and/or pr bounds.}

\item{chunk_size}{Chunk size used in marginal evaluations.}

\item{diagnostics}{Logical; attach diagnostic attributes?}

\item{verbose}{Logical; print progress messages?}
}
\value{
Data frame with scenario_grid columns plus one weight column per group.
}
\description{
For each group (e.g., SSP), fits a Gaussian copula to the dependence structure
between temperature and precipitation after transforming each marginal using a
weighted 1D Gaussian-kernel KDE CDF. The joint density is evaluated on
`scenario_grid` (evaluation surface). If `normalize=TRUE`, the resulting surface
weights are normalized to sum to 1 (optionally area-weighted for regular grids).

Interpretation: outputs are *relative surface weights* induced by the fitted model
and the evaluation surface; they are not calibrated probabilities.
}
