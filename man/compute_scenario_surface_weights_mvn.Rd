% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scenario_surface_weights_mvn.R
\name{compute_scenario_surface_weights_mvn}
\alias{compute_scenario_surface_weights_mvn}
\title{Calculate Climate-Informed Scenario Weights (MVN; external per-row weights)}
\usage{
compute_scenario_surface_weights_mvn(
  ensemble_data,
  scenario_grid,
  pr_col = "prcp",
  ta_col = "tavg",
  group_col = "scenario",
  robust = TRUE,
  min_samples = 5L,
  normalize = TRUE,
  area_weight = c("regular", "none"),
  scale = c("none", "global", "by_group"),
  weights_col = NULL,
  support = NULL,
  diagnostics = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{ensemble_data}{Data frame containing ensemble projections.}

\item{scenario_grid}{Data frame defining the evaluation grid.}

\item{pr_col}{Column name for precipitation variable.}

\item{ta_col}{Column name for temperature variable.}

\item{group_col}{Column name for grouping (e.g., scenario).}

\item{robust}{Logical; use robust covariance estimation?}

\item{min_samples}{Minimum observations required per group.}

\item{normalize}{Logical; normalize to PMF?}

\item{area_weight}{Area weighting method: "regular" or "none".}

\item{scale}{Scaling method: "none", "global", or "by_group".}

\item{weights_col}{Optional column with per-row weights (incompatible with robust=TRUE).}

\item{support}{Optional list with ta and/or pr bounds.}

\item{diagnostics}{Logical; attach diagnostic attributes?}

\item{verbose}{Logical; print progress messages?}
}
\value{
Data frame in long format with `scenario_grid` columns plus:
- `scenario`: scenario/group label
- `weight`: numeric weights per grid point
}
\description{
For each group, fits a bivariate normal distribution to (ta, pr) and evaluates
its density on `scenario_grid`. If `normalize=TRUE`, returns a discrete PMF over
grid points (optionally area-weighted for regular grids).
}
