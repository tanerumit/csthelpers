% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GCMplausibilityRange.R
\name{GCMplausibilityRange}
\alias{GCMplausibilityRange}
\title{Compute Plausibility Ranges for GCM Scenarios}
\usage{
GCMplausibilityRange(
  str.data = NULL,
  gcm.data = NULL,
  gcm.scenarios = NULL,
  clevel = 0.95,
  location.list
)
}
\arguments{
\item{str.data}{Optional. Data frame containing historical or reference
response-surface values used for interpolation. Structure must be
compatible with the response variable extracted from \code{str_dfl}.}

\item{gcm.data}{Data frame of GCM outputs containing at least the variables
\code{scenario}, \code{prcp}, and \code{tavg}. Used to compute scenario-
specific ellipses.}

\item{gcm.scenarios}{Character vector of scenario identifiers to evaluate.}

\item{clevel}{Numeric. Confidence level for the ellipse constructed via
\code{stat_ellipse()}. Default is \code{0.95}.}

\item{location.list}{Vector of location identifiers over which plausibility
ranges are computed.}
}
\value{
A data frame containing:
\describe{
  \item{scenario}{Scenario identifier.}
  \item{location}{Location identifier.}
  \item{lo}{Lower plausibility bound.}
  \item{up}{Upper plausibility bound.}
}
}
\description{
Computes lower and upper bounds of a response surface for multiple GCM
scenarios and locations. The function constructs interpolated response
surfaces, extracts scenario-specific ellipses in \code{prcpâ€“tavg} space,
identifies intersecting points, and evaluates the corresponding response
values to derive plausibility ranges.
}
\details{
The function:
\enumerate{
  \item Generates a base grid of \code{prcp} and \code{tavg} values using
        interpolation over unique precipitation and temperature axes.
  \item Extracts points from this grid and determines which points lie inside
        the scenario-specific ellipses derived from \code{gcm.data}.
  \item For each location in \code{location.list}, constructs an interpolated
        response surface and evaluates the response variable at the
        ellipse-intersection points.
  \item Computes lower and upper bounds of the resulting response values.
}

The function returns a data frame with one row per combination of scenario
and location.
}
\note{
This function relies on external objects such as \code{tavg_unique},
\code{prcp_unique}, and \code{str_dfl}. These must exist in the calling
environment. Ellipse extraction uses ggplot2 internals via
\code{ggplot_build()}.
}
\examples{
\dontrun{
GCMplausibilityRange(
  str.data = ref_surface,
  gcm.data = gcm_outputs,
  gcm.scenarios = c("ssp126", "ssp585"),
  clevel = 0.95,
  location.list = c("loc1", "loc2")
)
}

}
