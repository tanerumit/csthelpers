% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scenario_probabilities.R
\name{estimate_scenario_probs_kde}
\alias{estimate_scenario_probs_kde}
\title{Calculate Climate-Informed Scenario Weights (KDE; external per-row weights)}
\usage{
estimate_scenario_probs_kde(
  ensemble_data,
  scenario_grid,
  pr_col = "prcp",
  ta_col = "tavg",
  group_col = "scenario",
  bw = NULL,
  bw_method = c("auto", "plugin", "nrd"),
  k = c(1.5, 2),
  alpha = 1,
  bw_min = c(0, 0),
  bw_max = c(Inf, Inf),
  min_samples = 5L,
  normalize = TRUE,
  area_weight = c("regular", "none"),
  scale = c("none", "global", "by_group"),
  weights_col = NULL,
  support = NULL,
  chunk_size = 5000L,
  diagnostics = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{ensemble_data}{Data frame containing ensemble projections.}

\item{scenario_grid}{Data frame defining the evaluation grid.}

\item{pr_col}{Column name for precipitation variable.}

\item{ta_col}{Column name for temperature variable.}

\item{group_col}{Column name for grouping (e.g., scenario).}

\item{bw}{Optional user-specified bandwidth vector c(bw_ta, bw_pr).}

\item{bw_method}{Bandwidth selection method: "auto", "plugin", or "nrd".}

\item{k}{Grid-step multipliers for bandwidth floor.}

\item{alpha}{Multiplier for data-driven bandwidth.}

\item{bw_min}{Minimum bandwidth bounds.}

\item{bw_max}{Maximum bandwidth bounds.}

\item{min_samples}{Minimum observations required per group.}

\item{normalize}{Logical; normalize to PMF?}

\item{area_weight}{Area weighting method: "regular" or "none".}

\item{scale}{Scaling method: "none", "global", or "by_group".}

\item{weights_col}{Optional column with per-row weights.}

\item{support}{Optional list with ta and/or pr bounds.}

\item{chunk_size}{Grid evaluation chunk size.}

\item{diagnostics}{Logical; attach diagnostic attributes?}

\item{verbose}{Logical; print progress messages?}
}
\value{
Data frame with scenario_grid columns plus one weight column per group.
}
\description{
For each group (e.g., SSP), fits a 2D Gaussian product-kernel KDE to ensemble
(ta, pr) points and evaluates it on `scenario_grid`. If `normalize=TRUE`, returns
a discrete PMF over grid points (optionally area-weighted for regular grids).
}
