CONTEXT
You are modifying an R package repo (csthelpers). Work in-place from the package root.

GOAL
Improve correctness, readability, maintainability, numerical stability, and testability with minimal, surgical changes.

HARD CONSTRAINTS (NON-NEGOTIABLE)
- Keep all files UTF-8.
- Do not change exported function names, arguments, defaults, or return structures unless explicitly instructed.
- Preserve numerical outputs within tolerance 1e-12 unless methodology changes are explicitly requested.
- Do not add new external dependencies. Do not require Suggests packages at runtime. If unavoidable, guard with requireNamespace() and justify.
- Do not introduce purrr or functional-programming rewrites; use explicit for loops and base R idioms.
- Preserve deterministic behavior; control randomness/seeds explicitly where relevant.
- Minimal diff: modify only what is necessary; no sweeping refactors or style-only reformatting. Do not rename/move files unless instructed.
- Do not silently change user-visible outputs, warnings, or errors; document any necessary changes in the final summary.
- Do not silently drop columns/fields/rows.
- Do not provide backwards compatability unless you are explicitly asked to do so.

NON-INTERACTIVE EXECUTION (MANDATORY)
- Execute end-to-end in a single pass without questions or confirmations.
- Do not provide interim progress updates.
- If ambiguous, apply the smallest conservative assumption consistent with package conventions and document it at the end.
- Update tests when behavior changes or coverage gaps exist.
- Run tests at the end; stop only when requested changes are implemented and tests pass (or only external/irreproducible failures remain).

STYLE & STRUCTURE
- Prefer guard clauses/early returns; explicit type/length checks (use existing helpers where available).
- Avoid deep nesting; extract helpers only when it materially improves readability.
- Avoid asymptotic regressions; preallocate; avoid O(nÂ²) patterns on time-series data.

DOCUMENTATION
- Exported functions:
  Update roxygen2 to match behavior exactly.
  - @description: single, precise paragraph
  - @details: key assumptions and edge cases (brief)
  - @param: precise types, dimensions, units, NA handling
  - @return: exact structure, classes, and fields
  - @examples: minimal and fast; wrap expensive code in \dontrun{}
- Internal functions:
  Minimal documentation; use @keywords internal only when necessary.
- Do not invent parameters, defaults, or behavior.

TESTS
- Tests must be deterministic; no network, large fixtures, or uncontrolled randomness.
- Cover input validation, NA handling, empty/constant series, methodological consistency, return structure.
- Group tests by function/group; at top of each test file list functions under test with relative paths.

FINAL OUTPUT (ONCE COMPLETE)
- Bullet summary: what changed, why, risks/assumptions.
- List of files changed.
- Explicit design choices.
- Report remaining issues only if external/irreproducible.

 DONE CRITERIA
- New tests pass.
- Existing tests pass.
- No change to exported function signatures or return structures.

TASK:
- Check inconsistencies due to improved function names 
- Revise unit tests and make sure they do not fail

 